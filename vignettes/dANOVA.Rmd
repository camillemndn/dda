---
title: "dANOVA"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{dANOVA}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(dda)
library(tidyverse)
data(vietnam_temperature)
data(vietnam_regions)
```

```{r before}
selected_years <- 1987:1989

temp <- vietnam_temperature |>
  filter(year %in% selected_years) |>
  group_by(region)

smooth <- function(...) {
  density(
    rangeval = c(10, 40),
    lambda = 0, nbasis = 11, ...
  )
}

temp <- temp |> mutate(t_max_dd = lapply(t_max, smooth))

mean_by_region <- temp |> summarize(mean = list(mean(dda:::merge.dd(t_max_dd))))

# Means by region
plot(dda:::merge.dd(mean_by_region$mean))

# Total mean
plot(mean(dda:::merge.dd(mean_by_region$mean)))
```
